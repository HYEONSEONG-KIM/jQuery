<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0/EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace = "board">
	<typeAlias alias="boardVo" type="kr.or.ddit.board.vo.BoardVO"/>
	<typeAlias alias="replyVo" type="kr.or.ddit.board.vo.ReplyVO"/>
	
	<select id="boardList" resultClass="boardVo" parameterClass="map">
		select A.* from (
    	select rownum as rnum, B.*  from (
        select * from board 
        order by num desc) B
     	<![CDATA[
     	where rownum <= #end#) A 
 		where A.rnum >= #start#
 		]]>
	</select>
	
	<select id="countList" resultClass="int">
		select count(*) from board
	</select>
	
	<insert id="insertBoard" parameterClass="boardVo">
		insert into board(NUM, SUBJECT, WRITER, MAIL, PASSWORD, CONTENT, HIT, WIP, WDATE)
		values(board_num_seq.nextval, #subject#, #writer#, #mail#, #password#, #content#, 0, #wip#, sysdate)
		
		<selectKey keyProperty="num" resultClass="int">
			select board_num_seq.currval from dual
		</selectKey>
	</insert>
	
	<!-- 댓글 저장 -->
	<insert id="insertReply" parameterClass="replyVo">
		insert into reply values(reply_renum_seq.nextval,#bonum#,#name#,#cont#,sysdate)
		
		<selectKey keyProperty="renum" resultClass="int">
			select reply_renum_seq.currval from dual
		</selectKey>
	</insert>
	
	<!-- 댓글 리스트 -->
	<select id="replyList" parameterClass="int" resultClass="replyVo">
		select * from reply where bonum = #num#
	</select>
	
	<!-- 댓글 수정 -->
	<update id="replyUpdate" parameterClass="replyVo">
		update reply set  cont = #cont#, 
			redate = sysdate where renum = #renum#
	</update>

	<!-- 댓글 삭제 -->	
	<delete id="replyDelete" parameterClass="int">
		delete from reply where renum = #renum#
	</delete>
	
</sqlMap>



